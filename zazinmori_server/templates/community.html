{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Tivo is a HTML landing page template built with Bootstrap to help you crate engaging presentations for SaaS apps and convert visitors into users.">
    <meta name="author" content="Inovatik">

    <!-- OG Meta Tags to improve the way the post looks when you share the page on LinkedIn, Facebook, Google+ -->
	<meta property="og:site_name" content="" /> <!-- website name -->
	<meta property="og:site" content="" /> <!-- website link -->
	<meta property="og:title" content=""/> <!-- title shown in the actual shared post -->
	<meta property="og:description" content="" /> <!-- description shown in the actual shared post -->
	<meta property="og:image" content="" /> <!-- image link, make sure it's jpg -->
	<meta property="og:url" content="" /> <!-- where do you want your post to link to -->
	<meta property="og:type" content="article" />

    <!-- Website Title -->
    <title>zazinmori</title>
    
    <!-- Styles -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap&subset=latin-ext" rel="stylesheet">
    <link href="{% static 'css/bootstrap.css' %}" rel="stylesheet">
    <link href="{% static 'css/fontawesome-all.css' %}" rel="stylesheet">
    <link href="{% static 'css/swiper.css' %}" rel="stylesheet">
	<link href="{% static 'css/magnific-popup.css' %}" rel="stylesheet">
	<link href="{% static 'css/styles.css' %}" rel="stylesheet">
	
	<!-- Favicon  -->
    <link rel="icon" href="{% static 'img/favicon.png' %}">

    <!-- JQuery-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body data-spy="scroll" data-target=".fixed-top">
    
    <!-- Preloader -->
	<div class="spinner-wrapper">
        <div class="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
        </div>
    </div>
    <!-- end of preloader -->

    

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom fixed-top">
        <div class="container">

            <!-- Text Logo - Use this if you don't have a graphic logo -->
            <a href="/"><img style="width:30px; height:30px; margin-top: -5px;" src="{% static 'img/logo_w.png' %}"></a>
            <h3 class="fw-bold text-white pointer" onclick="to_home()">zazinmori</h3>

            <!-- Mobile Menu Toggle Button -->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-awesome fas fa-bars"></span>
                <span class="navbar-toggler-awesome fas fa-times"></span>
            </button>
            <!-- end of mobile menu toggle button -->

            <div class="collapse navbar-collapse" id="navbarsExampleDefault">
                <ul class="navbar-nav ml-auto">
                    {% if not context.user_email %}
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link page-scroll" href="/">HOME</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link page-scroll" href="/company/">SEARCH</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link page-scroll" href="/community/">COMMUNITY</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link page-scroll" href="/mypage/">MYPAGE</a>
                        </li>
                    {% endif %}
                </ul>
                <span class="nav-item">
                    {% if not context.user_email %}
                        <a class="btn-outline-sm" href="/login/">LOG IN</a>
                    {% else %}
                        <a class="btn-outline-sm" href="/logout/">LOG OUT</a>
                    {% endif %}
                </span>
            </div>
        </div> <!-- end of container -->
    </nav> <!-- end of navbar -->
    <!-- end of navigation -->

    <!-- Header -->
    <header id="header" class="ex-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1>Community</h1>
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </header> <!-- end of ex-header -->
    <!-- end of header -->



    <!-- Pricing -->
    <div id="pricing" class="cards-2">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="h2-heading"><span class="f-c4">자</span>진모리<span class="f-c4">만</span>의 <span class="f-c4">추</span>천 채용</h1>
                </div> <!-- end of col -->
            </div> <!-- end of row -->
            <div id="recom_total" class="row">
                <div class="col-lg-3">
                    <span class="recom_head">이번 주 이용자들이<br>가장 많이 검색한</span>
                    <div class="recom_box" style="margin-top:10px;">
                        <p class="recom_font" id="corp_rank_0"><span class="font-weight-bold f-c5">카카오</span><br>제주특별자치도 제주시</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="corp_rank_1"><span class="font-weight-bold f-c5">삼성전자</span><br>경기도 수원시</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="corp_rank_2"><span class="font-weight-bold f-c5">현대자동차</span><br>서울특별시 서초구</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="corp_rank_3"><span class="font-weight-bold f-c5">네이버</span><br>경기도 성남시</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="corp_rank_4"><span class="font-weight-bold f-c5">한화</span><br>서울특별시 중구</p>
                    </div>
                </div> <!-- end of col -->
                <div class="col-lg-3">
                    <span id="recom_head_2" class="recom_head">서울 지원자들이<br>가장 많이 검색한</span>
                    <div class="recom_box" style="margin-top:10px;">
                        <p class="recom_font" id="job_rank_0"><span class="font-weight-bold f-c5">현대자동차</span><br>서울특별시 서초구</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="job_rank_1"><span class="font-weight-bold f-c5">네이버</span><br>경기도 성남시</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="job_rank_2"><span class="font-weight-bold f-c5">넥슨코리아</span><br>경기도 성남시</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="job_rank_3"><span class="font-weight-bold f-c5">삼성전자</span><br>경기도 수원시</p>
                    </div>
                    <div class="recom_box">
                        <p class="recom_font" id="job_rank_4"><span class="font-weight-bold f-c5">카카오</span><br>제주특별자치도 제주시</p>
                    </div>
                </div> <!-- end of col -->
                <div class="col-lg-3">
                    <span id="recom_head_3" class="recom_head">서비스업 이용자들이<br>가장 많이 스크랩한</span>
                    <div class="recom_box container" style="margin-top:10px;">
                        <p class="recom_font" id="area_rank_0"><span class="font-weight-bold f-c5">현대자동차</span><br>서울특별시 서초구</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="area_rank_1"><span class="font-weight-bold f-c5">네이버</span><br>경기도 성남시</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="area_rank_2"><span class="font-weight-bold f-c5">넥슨코리아</span><br>경기도 성남시</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="area_rank_3"><span class="font-weight-bold f-c5">삼성전자</span><br>경기도 수원시</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="area_rank_4"><span class="font-weight-bold f-c5">카카오</span><br>제주특별자치도 제주시</p>
                    </div>
                </div> <!-- end of col -->
                <div class="col-lg-3">
                    <span class="recom_head">자진모리 이용자들이<br>가장 많이 스크랩한</span>
                    <div class="recom_box container" style="margin-top:10px;">
                        <p class="recom_font" id="scrap_rank_0"><span class="font-weight-bold f-c5">삼성전자</span><br>2022.09.06 ~ 2022.09.14</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="scrap_rank_1"><span class="font-weight-bold f-c5">신한은행</span><br>2022.08.31 ~ 2022.09.13</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="scrap_rank_2"><span class="font-weight-bold f-c5">멀티캠퍼스</span><br>2022.08.19 ~ 2022.08.29</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="scrap_rank_3"><span class="font-weight-bold f-c5">카카오</span><br>2022.09.01 ~ 2022.09.19</p>
                    </div>
                    <div class="recom_box container">
                        <p class="recom_font" id="scrap_rank_4"><span class="font-weight-bold f-c5">삼성전자</span><br>2022.09.06~2022.09.14</p>
                    </div>
                </div> <!-- end of col -->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of cards-2 -->
    <!-- end of pricing -->



    <!-- Board Content -->
    <div class="ex-basic-2">
        <div class="container">
            <div class="row">
                <div id="main" class="col-lg-12">
                    <!--<div class="image-container-large">
                        <img class="img-fluid" src="{% static 'img/article-details-large.jpg' %}" alt="alternative">
                    </div> end of image-container-large -->
                    <div class="text-container">
                        <table class="table table-hover text-center">
                            <thead>
                                <tr>
                                    <th class="wk" style="width:10%;">번호</th>
                                    <th class="wk" style="width:60%;">제목</th>
                                    <th class="wk" style="width:15%;">작성자</th>
                                    <th class="wk" style="width:15%;">작성일</th>
                                </tr>
                            </thead>
                            <tbody>                    
                                {% if not context.page_obj %}
                                <tr>
                                    <td colspan="4" align="center">----------작성된 글이 없습니다----------</td>
                                </tr>
                                {% else %}
                                    {% for data in context.page_obj %}
                                    <tr>
                                        <td class="wk">{{ data.post_id }}</td>
                                        <td class="wk pointer" onclick="document.location='/community/post_detail/{{ data.post_id }}'">{{ data.title }}</td>
                                        <td class="wk">{{ data.name }}</td>
                                        <td class="wk">{{ data.written_date }}</td>
                                    </tr>
                                    {% endfor %}
                                {% endif %}
                            </tbody>
                        </table>
                        <br><br>

                        <div>
                            <nav aria-label="Page navigation">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item">
                                    <a class="page-link" href="?page=1" aria-label="First" style="color:#5f4dee;">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">First</span>
                                    </a>
                                    </li>
                                    {% for page_num in context.page_obj.paginator.page_range %}
                                        {% if page_num == context.page_obj.number %}
                                            <li class="page-item active"><a class="page-link" href="#" style="background-color:#5f4dee; border: 1px solid #5f4dee;">{{ page_num }}</a></li>
                                        {% else %}
                                            <li class="page-item"><a class="page-link" href="?page={{ page_num }}" style="color:#5f4dee;">{{ page_num}}</a></li>
                                        {% endif %}
                                    {% endfor %}
                                    <li class="page-item">
                                    <a class="page-link" href="?page={{ context.page_obj.paginator.num_pages }}" aria-label="Last" style="color:#5f4dee;">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Last</span>
                                    </a>
                                    </li>
                                </ul>
                            </nav>
                        </div>                 
                    </div> <!-- end of text-container -->

                    <div class="text-center mx-auto">
                        <button class="btn-outline-reg mx-2" onclick="back()">BACK</button>
                        {% if not context.user_email %}
                            <button class="btn-solid-reg mx-2"style="width: 15rem;" onclick="to_login()">WRITE</button>
                        {% else %}
                            <button class="btn-solid-reg mx-2"style="width: 15rem;" onclick="location.href='/community/write/'">WRITE</button>
                        {% endif %}
                    </div>
                </div> <!-- end of col-->
            </div> <!-- end of row -->
        </div> <!-- end of container -->
    </div> <!-- end of ex-basic-2 -->
    <!-- end of Board content -->



    <!-- Footer -->
    <svg class="footer-frame" data-name="Layer 2" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 1920 79"><defs><style>.cls-2{fill:#5f4def;}</style></defs><title>footer-frame</title><path class="cls-2" d="M0,72.427C143,12.138,255.5,4.577,328.644,7.943c147.721,6.8,183.881,60.242,320.83,53.737,143-6.793,167.826-68.128,293-60.9,109.095,6.3,115.68,54.364,225.251,57.319,113.58,3.064,138.8-47.711,251.189-41.8,104.012,5.474,109.713,50.4,197.369,46.572,89.549-3.91,124.375-52.563,227.622-50.155A338.646,338.646,0,0,1,1920,23.467V79.75H0V72.427Z" transform="translate(0 -0.188)"/></svg>
    <!-- end of footer -->


    <!-- Copyright -->
    <div class="copyright">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <p class="p-small">
                        Copyright © 2022<br>Team Ikuzo
                    </p>
                </div> <!-- end of col -->
            </div> <!-- enf of row -->
        </div> <!-- end of container -->
    </div> <!-- end of copyright --> 
    <!-- end of copyright -->
    
    	
    <!-- Scripts -->
    <script src="{% static 'js/jquery.min.js' %}"></script> <!-- jQuery for Bootstrap's JavaScript plugins -->
    <script src="{% static 'js/popper.min.js' %}"></script> <!-- Popper tooltip library for Bootstrap -->
    <script src="{% static 'js/bootstrap.min.js' %}"></script> <!-- Bootstrap framework -->
    <script src="{% static 'js/jquery.easing.min.js' %}"></script> <!-- jQuery Easing for smooth scrolling between anchors -->
    <script src="{% static 'js/swiper.min.js' %}"></script> <!-- Swiper for image and text sliders -->
    <script src="{% static 'js/jquery.magnific-popup.js' %}"></script> <!-- Magnific Popup for lightboxes -->
    <script src="{% static 'js/validator.min.js' %}"></script> <!-- Validator.js - Bootstrap plugin that validates forms -->
    <script src="{% static 'js/scripts.js' %}"></script> <!-- Custom scripts -->
</body>

<script>

    function to_home(){
        document.location = '/';
    }

    function to_login(){
      if(confirm("로그인 후에 서비스를 이용할 수 있습니다.")) document.location = '/login/';
    }

    function back(){
        if(confirm("이전 페이지로 돌아가시겠습니까?")) window.history.back();
    }

    window.onload = function(){
        $.ajax({
            url: '/community/',
            type: 'POST',
            data: {},
            dataType: 'json',
            success: function(context) {
                console.log('success');
                console.log(context);

                var user_exists = context.user_exists
                if ( user_exists == 0 ){
                    $('#recom_total').empty();
                    $('#recom_total').html('<div class="col-4 mx-auto text-weight-bold r-border1">"로그인 후 추천 기업을 확인해보세요"</div>');              
                } else if (user_exists == 'err') {
                    $('#recom_total').empty();
                    $('#recom_total').html('<div class="col-4 mx-auto text-weight-bold r-border1">"로딩 중 에러가 발생했습니다"</div>');
                } else {
                    var user_area = context.user_area;
                    var user_category = context.user_category;

                    $('#recom_head_2').html(`${user_category} 지원자들이<br>가장 많이 검색한`);
                    $('#recom_head_3').html(`${user_area} 지원자들이<br>가장 많이 검색한`);

                    for (var i=0; i<5; i++){
                        var corp_nm = context.corp_rank[i].corp_nm;
                        var addr = context.corp_rank[i].addr;
                        $(`#corp_rank_${i}`).html(`<span class="font-weight-bold f-c5">${corp_nm}</span><br>${addr}`);

                        var corp_nm = context.job_rank[i].corp_nm;
                        var addr = context.job_rank[i].addr;
                        $(`#job_rank_${i}`).html(`<span class="font-weight-bold f-c5">${corp_nm}</span><br>${addr}`);

                        var corp_nm = context.area_rank[i].corp_nm;
                        var addr = context.area_rank[i].addr;
                        $(`#area_rank_${i}`).html(`<span class="font-weight-bold f-c5">${corp_nm}</span><br>${addr}`);

                        var corp_nm = context.scrap_rank[i].corp_nm;
                        var start_time = context.scrap_rank[i].start_time;
                        var end_time = context.scrap_rank[i].end_time;
                        $(`#scrap_rank_${i}`).html(`<span class="font-weight-bold f-c5">${corp_nm}</span><br>${start_time} ~ ${end_time}`);
                    }
                }                
            },
            error: function(){
                console.log('fail');
                alert('서버 에러');
            }
        }); //ajax끝
    }


</script>
</html>